# Financial Forecasting Service with Arbitrary Horizons

## –û–ø–∏—Å–∞–Ω–∏–µ
–°–µ—Ä–≤–∏—Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (k –¥–Ω–µ–π). –ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —Å–æ—á–µ—Ç–∞—é—â–∏–π –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã –∫–æ—Ç–∏—Ä–æ–≤–æ–∫, –Ω–æ–≤–æ—Å—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ FinBERT –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É Transformer.

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- üéØ –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ª—é–±—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –¥–Ω–µ–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1, 5, 10, 20 –¥–Ω–µ–π)

- ü§ñ –ì–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - Transformer –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ + FinBERT –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π

- üìä –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ - 100+ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫

- üéØ –ú–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ - –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤

- üîÑ –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –¥–ª—è –¥–Ω–µ–π 1-20

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ CUDA
nvidia-smi


# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- GPU: NVIDIA —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA (‚â•8GB VRAM)
- PyTorch: —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA
```
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd <repository-name>
```
### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
```bash
python programm_with_feature.py --mode train \
    --candles candles.csv candles_2.csv \
    --news news.csv news_2.csv \
    --k_days 1 5 10 20 \
    --model_dir my_model
```
### –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
python programm_with_feature.py --mode predict \
    --candles candles.csv \
    --news news.csv \
    --k_days 1 5 10 20 \
    --output predictions.csv \
    --model_dir my_model
```
### –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
```bash
python programm_with_feature.py --mode evaluate \
    --candles candles.csv \
    --news news.csv \
    --k_days 1 5 10 20 \
    --model_dir my_model
```
### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

- --mode: –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (train/predict/evaluate)
- --candles: –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º —Å –∫–æ—Ç–∏—Ä–æ–≤–∫–∞–º–∏
- --news: –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º —Å –Ω–æ–≤–æ—Å—Ç—è–º–∏
- --k_days: –ì–æ—Ä–∏–∑–æ–Ω—Ç—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1 20)
- --output: –§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- --model_dir: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏
- --evaluate: –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫—É –ø–æ—Å–ª–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–ö–æ—Ç–∏—Ä–æ–≤–∫–∏: open, close, high, low, volume, begin, ticker

–ù–æ–≤–æ—Å—Ç–∏: publish_date, title, publication

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: ticker, p1, p2, ..., p20 (–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –Ω–∞ 1-20 –¥–Ω–µ–π)

## –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏
- MAE (Mean Absolute Error)

- Brier Score –¥–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ä–æ—Å—Ç–∞

- Direction Accuracy - —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- Final Score - –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞
